// Code generated by pulumi-language-go DO NOT EDIT.
// *** WARNING: Do not edit by hand unless you're certain you know what you are doing! ***

package edgeservices

import (
	"context"
	"reflect"

	"errors"
	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
	"github.com/pulumiverse/pulumi-scaleway/sdk/go/scaleway/internal"
)

// Creates and manages Scaleway Edge Services Cache Stages.
//
// ## Example Usage
//
// ### Basic
//
// ```go
// package main
//
// import (
//
//	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
//	"github.com/pulumiverse/pulumi-scaleway/sdk/go/scaleway/edgeservices"
//
// )
//
//	func main() {
//		pulumi.Run(func(ctx *pulumi.Context) error {
//			_, err := edgeservices.NewCacheStage(ctx, "main", &edgeservices.CacheStageArgs{
//				PipelineId:     pulumi.Any(mainScalewayEdgeServicesPipeline.Id),
//				BackendStageId: pulumi.Any(mainScalewayEdgeServicesBackendStage.Id),
//			})
//			if err != nil {
//				return err
//			}
//			return nil
//		})
//	}
//
// ```
//
// ### Purge request
//
// ```go
// package main
//
// import (
//
//	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
//	"github.com/pulumiverse/pulumi-scaleway/sdk/go/scaleway/edgeservices"
//
// )
//
//	func main() {
//		pulumi.Run(func(ctx *pulumi.Context) error {
//			_, err := edgeservices.NewCacheStage(ctx, "main", &edgeservices.CacheStageArgs{
//				PipelineId:     pulumi.Any(mainScalewayEdgeServicesPipeline.Id),
//				BackendStageId: pulumi.Any(mainScalewayEdgeServicesBackendStage.Id),
//				Purge: []map[string]interface{}{
//					map[string]interface{}{
//						"pipelineId": mainScalewayEdgeServicesPipeline.Id,
//						"all":        true,
//					},
//				},
//			})
//			if err != nil {
//				return err
//			}
//			return nil
//		})
//	}
//
// ```
//
// ## Import
//
// Cache stages can be imported using the `{id}`, e.g.
//
// bash
//
// ```sh
// $ pulumi import scaleway:edgeservices/cacheStage:CacheStage basic 11111111-1111-1111-1111-111111111111
// ```
type CacheStage struct {
	pulumi.CustomResourceState

	// The backend stage ID the cache stage will be linked to. Only one of `backendStageId`, `routeStageId` and `wafStageId` should be specified.
	BackendStageId pulumi.StringOutput `pulumi:"backendStageId"`
	// The date and time of the creation of the cache stage.
	CreatedAt pulumi.StringOutput `pulumi:"createdAt"`
	// The Time To Live (TTL) in seconds. Defines how long content is cached.
	FallbackTtl pulumi.IntPtrOutput `pulumi:"fallbackTtl"`
	// Defines whether responses to requests with cookies must be stored in the cache.
	IncludeCookies pulumi.BoolPtrOutput `pulumi:"includeCookies"`
	// The ID of the pipeline.
	PipelineId pulumi.StringOutput `pulumi:"pipelineId"`
	// `projectId`) The ID of the project the cache stage is associated with.
	ProjectId pulumi.StringOutput `pulumi:"projectId"`
	// The Scaleway Object Storage origin bucket (S3) linked to the backend stage.
	PurgeRequests CacheStagePurgeRequestArrayOutput `pulumi:"purgeRequests"`
	// Trigger a refresh of the cache by changing this field's value.
	RefreshCache pulumi.StringPtrOutput `pulumi:"refreshCache"`
	// The route stage ID the cache stage will be linked to. Only one of `backendStageId`, `routeStageId` and `wafStageId` should be specified.
	RouteStageId pulumi.StringOutput `pulumi:"routeStageId"`
	// The date and time of the last update of the cache stage.
	UpdatedAt pulumi.StringOutput `pulumi:"updatedAt"`
	// The WAF stage ID the cache stage will be linked to. Only one of `backendStageId`, `routeStageId` and `wafStageId` should be specified.
	WafStageId pulumi.StringOutput `pulumi:"wafStageId"`
}

// NewCacheStage registers a new resource with the given unique name, arguments, and options.
func NewCacheStage(ctx *pulumi.Context,
	name string, args *CacheStageArgs, opts ...pulumi.ResourceOption) (*CacheStage, error) {
	if args == nil {
		return nil, errors.New("missing one or more required arguments")
	}

	if args.PipelineId == nil {
		return nil, errors.New("invalid value for required argument 'PipelineId'")
	}
	aliases := pulumi.Aliases([]pulumi.Alias{
		{
			Type: pulumi.String("scaleway:index/edgeServicesCacheStage:EdgeServicesCacheStage"),
		},
	})
	opts = append(opts, aliases)
	opts = internal.PkgResourceDefaultOpts(opts)
	var resource CacheStage
	err := ctx.RegisterResource("scaleway:edgeservices/cacheStage:CacheStage", name, args, &resource, opts...)
	if err != nil {
		return nil, err
	}
	return &resource, nil
}

// GetCacheStage gets an existing CacheStage resource's state with the given name, ID, and optional
// state properties that are used to uniquely qualify the lookup (nil if not required).
func GetCacheStage(ctx *pulumi.Context,
	name string, id pulumi.IDInput, state *CacheStageState, opts ...pulumi.ResourceOption) (*CacheStage, error) {
	var resource CacheStage
	err := ctx.ReadResource("scaleway:edgeservices/cacheStage:CacheStage", name, id, state, &resource, opts...)
	if err != nil {
		return nil, err
	}
	return &resource, nil
}

// Input properties used for looking up and filtering CacheStage resources.
type cacheStageState struct {
	// The backend stage ID the cache stage will be linked to. Only one of `backendStageId`, `routeStageId` and `wafStageId` should be specified.
	BackendStageId *string `pulumi:"backendStageId"`
	// The date and time of the creation of the cache stage.
	CreatedAt *string `pulumi:"createdAt"`
	// The Time To Live (TTL) in seconds. Defines how long content is cached.
	FallbackTtl *int `pulumi:"fallbackTtl"`
	// Defines whether responses to requests with cookies must be stored in the cache.
	IncludeCookies *bool `pulumi:"includeCookies"`
	// The ID of the pipeline.
	PipelineId *string `pulumi:"pipelineId"`
	// `projectId`) The ID of the project the cache stage is associated with.
	ProjectId *string `pulumi:"projectId"`
	// The Scaleway Object Storage origin bucket (S3) linked to the backend stage.
	PurgeRequests []CacheStagePurgeRequest `pulumi:"purgeRequests"`
	// Trigger a refresh of the cache by changing this field's value.
	RefreshCache *string `pulumi:"refreshCache"`
	// The route stage ID the cache stage will be linked to. Only one of `backendStageId`, `routeStageId` and `wafStageId` should be specified.
	RouteStageId *string `pulumi:"routeStageId"`
	// The date and time of the last update of the cache stage.
	UpdatedAt *string `pulumi:"updatedAt"`
	// The WAF stage ID the cache stage will be linked to. Only one of `backendStageId`, `routeStageId` and `wafStageId` should be specified.
	WafStageId *string `pulumi:"wafStageId"`
}

type CacheStageState struct {
	// The backend stage ID the cache stage will be linked to. Only one of `backendStageId`, `routeStageId` and `wafStageId` should be specified.
	BackendStageId pulumi.StringPtrInput
	// The date and time of the creation of the cache stage.
	CreatedAt pulumi.StringPtrInput
	// The Time To Live (TTL) in seconds. Defines how long content is cached.
	FallbackTtl pulumi.IntPtrInput
	// Defines whether responses to requests with cookies must be stored in the cache.
	IncludeCookies pulumi.BoolPtrInput
	// The ID of the pipeline.
	PipelineId pulumi.StringPtrInput
	// `projectId`) The ID of the project the cache stage is associated with.
	ProjectId pulumi.StringPtrInput
	// The Scaleway Object Storage origin bucket (S3) linked to the backend stage.
	PurgeRequests CacheStagePurgeRequestArrayInput
	// Trigger a refresh of the cache by changing this field's value.
	RefreshCache pulumi.StringPtrInput
	// The route stage ID the cache stage will be linked to. Only one of `backendStageId`, `routeStageId` and `wafStageId` should be specified.
	RouteStageId pulumi.StringPtrInput
	// The date and time of the last update of the cache stage.
	UpdatedAt pulumi.StringPtrInput
	// The WAF stage ID the cache stage will be linked to. Only one of `backendStageId`, `routeStageId` and `wafStageId` should be specified.
	WafStageId pulumi.StringPtrInput
}

func (CacheStageState) ElementType() reflect.Type {
	return reflect.TypeOf((*cacheStageState)(nil)).Elem()
}

type cacheStageArgs struct {
	// The backend stage ID the cache stage will be linked to. Only one of `backendStageId`, `routeStageId` and `wafStageId` should be specified.
	BackendStageId *string `pulumi:"backendStageId"`
	// The Time To Live (TTL) in seconds. Defines how long content is cached.
	FallbackTtl *int `pulumi:"fallbackTtl"`
	// Defines whether responses to requests with cookies must be stored in the cache.
	IncludeCookies *bool `pulumi:"includeCookies"`
	// The ID of the pipeline.
	PipelineId string `pulumi:"pipelineId"`
	// `projectId`) The ID of the project the cache stage is associated with.
	ProjectId *string `pulumi:"projectId"`
	// The Scaleway Object Storage origin bucket (S3) linked to the backend stage.
	PurgeRequests []CacheStagePurgeRequest `pulumi:"purgeRequests"`
	// Trigger a refresh of the cache by changing this field's value.
	RefreshCache *string `pulumi:"refreshCache"`
	// The route stage ID the cache stage will be linked to. Only one of `backendStageId`, `routeStageId` and `wafStageId` should be specified.
	RouteStageId *string `pulumi:"routeStageId"`
	// The WAF stage ID the cache stage will be linked to. Only one of `backendStageId`, `routeStageId` and `wafStageId` should be specified.
	WafStageId *string `pulumi:"wafStageId"`
}

// The set of arguments for constructing a CacheStage resource.
type CacheStageArgs struct {
	// The backend stage ID the cache stage will be linked to. Only one of `backendStageId`, `routeStageId` and `wafStageId` should be specified.
	BackendStageId pulumi.StringPtrInput
	// The Time To Live (TTL) in seconds. Defines how long content is cached.
	FallbackTtl pulumi.IntPtrInput
	// Defines whether responses to requests with cookies must be stored in the cache.
	IncludeCookies pulumi.BoolPtrInput
	// The ID of the pipeline.
	PipelineId pulumi.StringInput
	// `projectId`) The ID of the project the cache stage is associated with.
	ProjectId pulumi.StringPtrInput
	// The Scaleway Object Storage origin bucket (S3) linked to the backend stage.
	PurgeRequests CacheStagePurgeRequestArrayInput
	// Trigger a refresh of the cache by changing this field's value.
	RefreshCache pulumi.StringPtrInput
	// The route stage ID the cache stage will be linked to. Only one of `backendStageId`, `routeStageId` and `wafStageId` should be specified.
	RouteStageId pulumi.StringPtrInput
	// The WAF stage ID the cache stage will be linked to. Only one of `backendStageId`, `routeStageId` and `wafStageId` should be specified.
	WafStageId pulumi.StringPtrInput
}

func (CacheStageArgs) ElementType() reflect.Type {
	return reflect.TypeOf((*cacheStageArgs)(nil)).Elem()
}

type CacheStageInput interface {
	pulumi.Input

	ToCacheStageOutput() CacheStageOutput
	ToCacheStageOutputWithContext(ctx context.Context) CacheStageOutput
}

func (*CacheStage) ElementType() reflect.Type {
	return reflect.TypeOf((**CacheStage)(nil)).Elem()
}

func (i *CacheStage) ToCacheStageOutput() CacheStageOutput {
	return i.ToCacheStageOutputWithContext(context.Background())
}

func (i *CacheStage) ToCacheStageOutputWithContext(ctx context.Context) CacheStageOutput {
	return pulumi.ToOutputWithContext(ctx, i).(CacheStageOutput)
}

// CacheStageArrayInput is an input type that accepts CacheStageArray and CacheStageArrayOutput values.
// You can construct a concrete instance of `CacheStageArrayInput` via:
//
//	CacheStageArray{ CacheStageArgs{...} }
type CacheStageArrayInput interface {
	pulumi.Input

	ToCacheStageArrayOutput() CacheStageArrayOutput
	ToCacheStageArrayOutputWithContext(context.Context) CacheStageArrayOutput
}

type CacheStageArray []CacheStageInput

func (CacheStageArray) ElementType() reflect.Type {
	return reflect.TypeOf((*[]*CacheStage)(nil)).Elem()
}

func (i CacheStageArray) ToCacheStageArrayOutput() CacheStageArrayOutput {
	return i.ToCacheStageArrayOutputWithContext(context.Background())
}

func (i CacheStageArray) ToCacheStageArrayOutputWithContext(ctx context.Context) CacheStageArrayOutput {
	return pulumi.ToOutputWithContext(ctx, i).(CacheStageArrayOutput)
}

// CacheStageMapInput is an input type that accepts CacheStageMap and CacheStageMapOutput values.
// You can construct a concrete instance of `CacheStageMapInput` via:
//
//	CacheStageMap{ "key": CacheStageArgs{...} }
type CacheStageMapInput interface {
	pulumi.Input

	ToCacheStageMapOutput() CacheStageMapOutput
	ToCacheStageMapOutputWithContext(context.Context) CacheStageMapOutput
}

type CacheStageMap map[string]CacheStageInput

func (CacheStageMap) ElementType() reflect.Type {
	return reflect.TypeOf((*map[string]*CacheStage)(nil)).Elem()
}

func (i CacheStageMap) ToCacheStageMapOutput() CacheStageMapOutput {
	return i.ToCacheStageMapOutputWithContext(context.Background())
}

func (i CacheStageMap) ToCacheStageMapOutputWithContext(ctx context.Context) CacheStageMapOutput {
	return pulumi.ToOutputWithContext(ctx, i).(CacheStageMapOutput)
}

type CacheStageOutput struct{ *pulumi.OutputState }

func (CacheStageOutput) ElementType() reflect.Type {
	return reflect.TypeOf((**CacheStage)(nil)).Elem()
}

func (o CacheStageOutput) ToCacheStageOutput() CacheStageOutput {
	return o
}

func (o CacheStageOutput) ToCacheStageOutputWithContext(ctx context.Context) CacheStageOutput {
	return o
}

// The backend stage ID the cache stage will be linked to. Only one of `backendStageId`, `routeStageId` and `wafStageId` should be specified.
func (o CacheStageOutput) BackendStageId() pulumi.StringOutput {
	return o.ApplyT(func(v *CacheStage) pulumi.StringOutput { return v.BackendStageId }).(pulumi.StringOutput)
}

// The date and time of the creation of the cache stage.
func (o CacheStageOutput) CreatedAt() pulumi.StringOutput {
	return o.ApplyT(func(v *CacheStage) pulumi.StringOutput { return v.CreatedAt }).(pulumi.StringOutput)
}

// The Time To Live (TTL) in seconds. Defines how long content is cached.
func (o CacheStageOutput) FallbackTtl() pulumi.IntPtrOutput {
	return o.ApplyT(func(v *CacheStage) pulumi.IntPtrOutput { return v.FallbackTtl }).(pulumi.IntPtrOutput)
}

// Defines whether responses to requests with cookies must be stored in the cache.
func (o CacheStageOutput) IncludeCookies() pulumi.BoolPtrOutput {
	return o.ApplyT(func(v *CacheStage) pulumi.BoolPtrOutput { return v.IncludeCookies }).(pulumi.BoolPtrOutput)
}

// The ID of the pipeline.
func (o CacheStageOutput) PipelineId() pulumi.StringOutput {
	return o.ApplyT(func(v *CacheStage) pulumi.StringOutput { return v.PipelineId }).(pulumi.StringOutput)
}

// `projectId`) The ID of the project the cache stage is associated with.
func (o CacheStageOutput) ProjectId() pulumi.StringOutput {
	return o.ApplyT(func(v *CacheStage) pulumi.StringOutput { return v.ProjectId }).(pulumi.StringOutput)
}

// The Scaleway Object Storage origin bucket (S3) linked to the backend stage.
func (o CacheStageOutput) PurgeRequests() CacheStagePurgeRequestArrayOutput {
	return o.ApplyT(func(v *CacheStage) CacheStagePurgeRequestArrayOutput { return v.PurgeRequests }).(CacheStagePurgeRequestArrayOutput)
}

// Trigger a refresh of the cache by changing this field's value.
func (o CacheStageOutput) RefreshCache() pulumi.StringPtrOutput {
	return o.ApplyT(func(v *CacheStage) pulumi.StringPtrOutput { return v.RefreshCache }).(pulumi.StringPtrOutput)
}

// The route stage ID the cache stage will be linked to. Only one of `backendStageId`, `routeStageId` and `wafStageId` should be specified.
func (o CacheStageOutput) RouteStageId() pulumi.StringOutput {
	return o.ApplyT(func(v *CacheStage) pulumi.StringOutput { return v.RouteStageId }).(pulumi.StringOutput)
}

// The date and time of the last update of the cache stage.
func (o CacheStageOutput) UpdatedAt() pulumi.StringOutput {
	return o.ApplyT(func(v *CacheStage) pulumi.StringOutput { return v.UpdatedAt }).(pulumi.StringOutput)
}

// The WAF stage ID the cache stage will be linked to. Only one of `backendStageId`, `routeStageId` and `wafStageId` should be specified.
func (o CacheStageOutput) WafStageId() pulumi.StringOutput {
	return o.ApplyT(func(v *CacheStage) pulumi.StringOutput { return v.WafStageId }).(pulumi.StringOutput)
}

type CacheStageArrayOutput struct{ *pulumi.OutputState }

func (CacheStageArrayOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*[]*CacheStage)(nil)).Elem()
}

func (o CacheStageArrayOutput) ToCacheStageArrayOutput() CacheStageArrayOutput {
	return o
}

func (o CacheStageArrayOutput) ToCacheStageArrayOutputWithContext(ctx context.Context) CacheStageArrayOutput {
	return o
}

func (o CacheStageArrayOutput) Index(i pulumi.IntInput) CacheStageOutput {
	return pulumi.All(o, i).ApplyT(func(vs []interface{}) *CacheStage {
		return vs[0].([]*CacheStage)[vs[1].(int)]
	}).(CacheStageOutput)
}

type CacheStageMapOutput struct{ *pulumi.OutputState }

func (CacheStageMapOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*map[string]*CacheStage)(nil)).Elem()
}

func (o CacheStageMapOutput) ToCacheStageMapOutput() CacheStageMapOutput {
	return o
}

func (o CacheStageMapOutput) ToCacheStageMapOutputWithContext(ctx context.Context) CacheStageMapOutput {
	return o
}

func (o CacheStageMapOutput) MapIndex(k pulumi.StringInput) CacheStageOutput {
	return pulumi.All(o, k).ApplyT(func(vs []interface{}) *CacheStage {
		return vs[0].(map[string]*CacheStage)[vs[1].(string)]
	}).(CacheStageOutput)
}

func init() {
	pulumi.RegisterInputType(reflect.TypeOf((*CacheStageInput)(nil)).Elem(), &CacheStage{})
	pulumi.RegisterInputType(reflect.TypeOf((*CacheStageArrayInput)(nil)).Elem(), CacheStageArray{})
	pulumi.RegisterInputType(reflect.TypeOf((*CacheStageMapInput)(nil)).Elem(), CacheStageMap{})
	pulumi.RegisterOutputType(CacheStageOutput{})
	pulumi.RegisterOutputType(CacheStageArrayOutput{})
	pulumi.RegisterOutputType(CacheStageMapOutput{})
}
