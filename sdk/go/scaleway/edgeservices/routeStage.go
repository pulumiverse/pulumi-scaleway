// Code generated by pulumi-language-go DO NOT EDIT.
// *** WARNING: Do not edit by hand unless you're certain you know what you are doing! ***

package edgeservices

import (
	"context"
	"reflect"

	"errors"
	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
	"github.com/pulumiverse/pulumi-scaleway/sdk/go/scaleway/internal"
)

// Creates and manages Scaleway Edge Services Route Stages.
//
// ## Example Usage
//
// ### Basic
//
// ```go
// package main
//
// import (
//
//	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
//	"github.com/pulumiverse/pulumi-scaleway/sdk/go/scaleway/edgeservices"
//
// )
//
//	func main() {
//		pulumi.Run(func(ctx *pulumi.Context) error {
//			_, err := edgeservices.NewRouteStage(ctx, "main", &edgeservices.RouteStageArgs{
//				PipelineId: pulumi.Any(mainScalewayEdgeServicesPipeline.Id),
//				WafStageId: pulumi.Any(waf.Id),
//				Rules: edgeservices.RouteStageRuleArray{
//					&edgeservices.RouteStageRuleArgs{
//						BackendStageId: pulumi.Any(backend.Id),
//						RuleHttpMatch: &edgeservices.RouteStageRuleRuleHttpMatchArgs{
//							MethodFilters: pulumi.StringArray{
//								pulumi.String("get"),
//								pulumi.String("post"),
//							},
//							PathFilter: &edgeservices.RouteStageRuleRuleHttpMatchPathFilterArgs{
//								PathFilterType: pulumi.String("regex"),
//								Value:          pulumi.String(".*"),
//							},
//						},
//					},
//				},
//			})
//			if err != nil {
//				return err
//			}
//			return nil
//		})
//	}
//
// ```
//
// ## Import
//
// Route stages can be imported using the `{id}`, e.g.
//
// bash
//
// ```sh
// $ pulumi import scaleway:edgeservices/routeStage:RouteStage basic 11111111-1111-1111-1111-111111111111
// ```
type RouteStage struct {
	pulumi.CustomResourceState

	// The date and time of the creation of the route stage.
	CreatedAt pulumi.StringOutput `pulumi:"createdAt"`
	// The ID of the pipeline.
	PipelineId pulumi.StringOutput `pulumi:"pipelineId"`
	// `projectId`) The ID of the project the route stage is associated with.
	ProjectId pulumi.StringOutput `pulumi:"projectId"`
	// The list of rules to be checked against every HTTP request. The first matching rule will forward the request to its specified backend stage. If no rules are matched, the request is forwarded to the WAF stage defined by `wafStageId`.
	Rules RouteStageRuleArrayOutput `pulumi:"rules"`
	// The date and time of the last update of the route stage.
	UpdatedAt pulumi.StringOutput `pulumi:"updatedAt"`
	// The ID of the WAF stage HTTP requests should be forwarded to when no rules are matched.
	WafStageId pulumi.StringPtrOutput `pulumi:"wafStageId"`
}

// NewRouteStage registers a new resource with the given unique name, arguments, and options.
func NewRouteStage(ctx *pulumi.Context,
	name string, args *RouteStageArgs, opts ...pulumi.ResourceOption) (*RouteStage, error) {
	if args == nil {
		return nil, errors.New("missing one or more required arguments")
	}

	if args.PipelineId == nil {
		return nil, errors.New("invalid value for required argument 'PipelineId'")
	}
	aliases := pulumi.Aliases([]pulumi.Alias{
		{
			Type: pulumi.String("scaleway:index/edgeServicesRouteStage:EdgeServicesRouteStage"),
		},
	})
	opts = append(opts, aliases)
	opts = internal.PkgResourceDefaultOpts(opts)
	var resource RouteStage
	err := ctx.RegisterResource("scaleway:edgeservices/routeStage:RouteStage", name, args, &resource, opts...)
	if err != nil {
		return nil, err
	}
	return &resource, nil
}

// GetRouteStage gets an existing RouteStage resource's state with the given name, ID, and optional
// state properties that are used to uniquely qualify the lookup (nil if not required).
func GetRouteStage(ctx *pulumi.Context,
	name string, id pulumi.IDInput, state *RouteStageState, opts ...pulumi.ResourceOption) (*RouteStage, error) {
	var resource RouteStage
	err := ctx.ReadResource("scaleway:edgeservices/routeStage:RouteStage", name, id, state, &resource, opts...)
	if err != nil {
		return nil, err
	}
	return &resource, nil
}

// Input properties used for looking up and filtering RouteStage resources.
type routeStageState struct {
	// The date and time of the creation of the route stage.
	CreatedAt *string `pulumi:"createdAt"`
	// The ID of the pipeline.
	PipelineId *string `pulumi:"pipelineId"`
	// `projectId`) The ID of the project the route stage is associated with.
	ProjectId *string `pulumi:"projectId"`
	// The list of rules to be checked against every HTTP request. The first matching rule will forward the request to its specified backend stage. If no rules are matched, the request is forwarded to the WAF stage defined by `wafStageId`.
	Rules []RouteStageRule `pulumi:"rules"`
	// The date and time of the last update of the route stage.
	UpdatedAt *string `pulumi:"updatedAt"`
	// The ID of the WAF stage HTTP requests should be forwarded to when no rules are matched.
	WafStageId *string `pulumi:"wafStageId"`
}

type RouteStageState struct {
	// The date and time of the creation of the route stage.
	CreatedAt pulumi.StringPtrInput
	// The ID of the pipeline.
	PipelineId pulumi.StringPtrInput
	// `projectId`) The ID of the project the route stage is associated with.
	ProjectId pulumi.StringPtrInput
	// The list of rules to be checked against every HTTP request. The first matching rule will forward the request to its specified backend stage. If no rules are matched, the request is forwarded to the WAF stage defined by `wafStageId`.
	Rules RouteStageRuleArrayInput
	// The date and time of the last update of the route stage.
	UpdatedAt pulumi.StringPtrInput
	// The ID of the WAF stage HTTP requests should be forwarded to when no rules are matched.
	WafStageId pulumi.StringPtrInput
}

func (RouteStageState) ElementType() reflect.Type {
	return reflect.TypeOf((*routeStageState)(nil)).Elem()
}

type routeStageArgs struct {
	// The ID of the pipeline.
	PipelineId string `pulumi:"pipelineId"`
	// `projectId`) The ID of the project the route stage is associated with.
	ProjectId *string `pulumi:"projectId"`
	// The list of rules to be checked against every HTTP request. The first matching rule will forward the request to its specified backend stage. If no rules are matched, the request is forwarded to the WAF stage defined by `wafStageId`.
	Rules []RouteStageRule `pulumi:"rules"`
	// The ID of the WAF stage HTTP requests should be forwarded to when no rules are matched.
	WafStageId *string `pulumi:"wafStageId"`
}

// The set of arguments for constructing a RouteStage resource.
type RouteStageArgs struct {
	// The ID of the pipeline.
	PipelineId pulumi.StringInput
	// `projectId`) The ID of the project the route stage is associated with.
	ProjectId pulumi.StringPtrInput
	// The list of rules to be checked against every HTTP request. The first matching rule will forward the request to its specified backend stage. If no rules are matched, the request is forwarded to the WAF stage defined by `wafStageId`.
	Rules RouteStageRuleArrayInput
	// The ID of the WAF stage HTTP requests should be forwarded to when no rules are matched.
	WafStageId pulumi.StringPtrInput
}

func (RouteStageArgs) ElementType() reflect.Type {
	return reflect.TypeOf((*routeStageArgs)(nil)).Elem()
}

type RouteStageInput interface {
	pulumi.Input

	ToRouteStageOutput() RouteStageOutput
	ToRouteStageOutputWithContext(ctx context.Context) RouteStageOutput
}

func (*RouteStage) ElementType() reflect.Type {
	return reflect.TypeOf((**RouteStage)(nil)).Elem()
}

func (i *RouteStage) ToRouteStageOutput() RouteStageOutput {
	return i.ToRouteStageOutputWithContext(context.Background())
}

func (i *RouteStage) ToRouteStageOutputWithContext(ctx context.Context) RouteStageOutput {
	return pulumi.ToOutputWithContext(ctx, i).(RouteStageOutput)
}

// RouteStageArrayInput is an input type that accepts RouteStageArray and RouteStageArrayOutput values.
// You can construct a concrete instance of `RouteStageArrayInput` via:
//
//	RouteStageArray{ RouteStageArgs{...} }
type RouteStageArrayInput interface {
	pulumi.Input

	ToRouteStageArrayOutput() RouteStageArrayOutput
	ToRouteStageArrayOutputWithContext(context.Context) RouteStageArrayOutput
}

type RouteStageArray []RouteStageInput

func (RouteStageArray) ElementType() reflect.Type {
	return reflect.TypeOf((*[]*RouteStage)(nil)).Elem()
}

func (i RouteStageArray) ToRouteStageArrayOutput() RouteStageArrayOutput {
	return i.ToRouteStageArrayOutputWithContext(context.Background())
}

func (i RouteStageArray) ToRouteStageArrayOutputWithContext(ctx context.Context) RouteStageArrayOutput {
	return pulumi.ToOutputWithContext(ctx, i).(RouteStageArrayOutput)
}

// RouteStageMapInput is an input type that accepts RouteStageMap and RouteStageMapOutput values.
// You can construct a concrete instance of `RouteStageMapInput` via:
//
//	RouteStageMap{ "key": RouteStageArgs{...} }
type RouteStageMapInput interface {
	pulumi.Input

	ToRouteStageMapOutput() RouteStageMapOutput
	ToRouteStageMapOutputWithContext(context.Context) RouteStageMapOutput
}

type RouteStageMap map[string]RouteStageInput

func (RouteStageMap) ElementType() reflect.Type {
	return reflect.TypeOf((*map[string]*RouteStage)(nil)).Elem()
}

func (i RouteStageMap) ToRouteStageMapOutput() RouteStageMapOutput {
	return i.ToRouteStageMapOutputWithContext(context.Background())
}

func (i RouteStageMap) ToRouteStageMapOutputWithContext(ctx context.Context) RouteStageMapOutput {
	return pulumi.ToOutputWithContext(ctx, i).(RouteStageMapOutput)
}

type RouteStageOutput struct{ *pulumi.OutputState }

func (RouteStageOutput) ElementType() reflect.Type {
	return reflect.TypeOf((**RouteStage)(nil)).Elem()
}

func (o RouteStageOutput) ToRouteStageOutput() RouteStageOutput {
	return o
}

func (o RouteStageOutput) ToRouteStageOutputWithContext(ctx context.Context) RouteStageOutput {
	return o
}

// The date and time of the creation of the route stage.
func (o RouteStageOutput) CreatedAt() pulumi.StringOutput {
	return o.ApplyT(func(v *RouteStage) pulumi.StringOutput { return v.CreatedAt }).(pulumi.StringOutput)
}

// The ID of the pipeline.
func (o RouteStageOutput) PipelineId() pulumi.StringOutput {
	return o.ApplyT(func(v *RouteStage) pulumi.StringOutput { return v.PipelineId }).(pulumi.StringOutput)
}

// `projectId`) The ID of the project the route stage is associated with.
func (o RouteStageOutput) ProjectId() pulumi.StringOutput {
	return o.ApplyT(func(v *RouteStage) pulumi.StringOutput { return v.ProjectId }).(pulumi.StringOutput)
}

// The list of rules to be checked against every HTTP request. The first matching rule will forward the request to its specified backend stage. If no rules are matched, the request is forwarded to the WAF stage defined by `wafStageId`.
func (o RouteStageOutput) Rules() RouteStageRuleArrayOutput {
	return o.ApplyT(func(v *RouteStage) RouteStageRuleArrayOutput { return v.Rules }).(RouteStageRuleArrayOutput)
}

// The date and time of the last update of the route stage.
func (o RouteStageOutput) UpdatedAt() pulumi.StringOutput {
	return o.ApplyT(func(v *RouteStage) pulumi.StringOutput { return v.UpdatedAt }).(pulumi.StringOutput)
}

// The ID of the WAF stage HTTP requests should be forwarded to when no rules are matched.
func (o RouteStageOutput) WafStageId() pulumi.StringPtrOutput {
	return o.ApplyT(func(v *RouteStage) pulumi.StringPtrOutput { return v.WafStageId }).(pulumi.StringPtrOutput)
}

type RouteStageArrayOutput struct{ *pulumi.OutputState }

func (RouteStageArrayOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*[]*RouteStage)(nil)).Elem()
}

func (o RouteStageArrayOutput) ToRouteStageArrayOutput() RouteStageArrayOutput {
	return o
}

func (o RouteStageArrayOutput) ToRouteStageArrayOutputWithContext(ctx context.Context) RouteStageArrayOutput {
	return o
}

func (o RouteStageArrayOutput) Index(i pulumi.IntInput) RouteStageOutput {
	return pulumi.All(o, i).ApplyT(func(vs []interface{}) *RouteStage {
		return vs[0].([]*RouteStage)[vs[1].(int)]
	}).(RouteStageOutput)
}

type RouteStageMapOutput struct{ *pulumi.OutputState }

func (RouteStageMapOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*map[string]*RouteStage)(nil)).Elem()
}

func (o RouteStageMapOutput) ToRouteStageMapOutput() RouteStageMapOutput {
	return o
}

func (o RouteStageMapOutput) ToRouteStageMapOutputWithContext(ctx context.Context) RouteStageMapOutput {
	return o
}

func (o RouteStageMapOutput) MapIndex(k pulumi.StringInput) RouteStageOutput {
	return pulumi.All(o, k).ApplyT(func(vs []interface{}) *RouteStage {
		return vs[0].(map[string]*RouteStage)[vs[1].(string)]
	}).(RouteStageOutput)
}

func init() {
	pulumi.RegisterInputType(reflect.TypeOf((*RouteStageInput)(nil)).Elem(), &RouteStage{})
	pulumi.RegisterInputType(reflect.TypeOf((*RouteStageArrayInput)(nil)).Elem(), RouteStageArray{})
	pulumi.RegisterInputType(reflect.TypeOf((*RouteStageMapInput)(nil)).Elem(), RouteStageMap{})
	pulumi.RegisterOutputType(RouteStageOutput{})
	pulumi.RegisterOutputType(RouteStageArrayOutput{})
	pulumi.RegisterOutputType(RouteStageMapOutput{})
}
